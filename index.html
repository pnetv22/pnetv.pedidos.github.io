<!DOCTYPE html>
<html>
<head>
    <title>Pixel Fighter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            image-rendering: pixelated;
        }
        body {
            background: #000;
            overflow: hidden;
        }
        #game {
            width: 960px;
            height: 540px;
            margin: auto;
            position: relative;
        }
        canvas {
            border: 2px solid #333;
        }
        .health-bar {
            position: absolute;
            top: 20px;
            width: 300px;
            height: 20px;
            border: 2px solid #fff;
        }
        #p1-health {
            left: 20px;
            background: linear-gradient(to right, #ff0000, #990000);
        }
        #p2-health {
            right: 20px;
            background: linear-gradient(to left, #ff0000, #990000);
        }
    </style>
</head>
<body>
    <div id="game">
        <div class="health-bar" id="p1-health"></div>
        <div class="health-bar" id="p2-health"></div>
        <canvas id="canvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const SCALE = 2;
        
        // Configuração inicial
        canvas.width = 960;
        canvas.height = 540;
        
        // Sistema de sprites
        const sprites = {
            ken: new Image(),
            ryu: new Image(),
            stage: new Image()
        };

        // Carregar sprites (substitua com suas próprias sprites)
        sprites.ken.src = 'data:image/png;base64,iVBORw0KG...';
        sprites.ryu.src = 'data:image/png;base64,iVBORw0KG...';
        sprites.stage.src = 'data:image/png;base64,iVBORw0KG...';

        // Sistema de personagem
        class Fighter {
            constructor(x, y, sprite, controls) {
                this.x = x;
                this.y = y;
                this.sprite = sprite;
                this.controls = controls;
                this.state = 'idle';
                this.frame = 0;
                this.health = 100;
                this.combo = 0;
                this.lastHit = 0;
                this.facing = 1;
            }

            update() {
                // Lógica de estado e animação
                if(this.state === 'attack' && this.frame > 6) {
                    this.setState('idle');
                }
                this.frame = (this.frame + 0.2) % 8;
            }

            setState(newState) {
                this.state = newState;
                this.frame = 0;
            }

            draw() {
                // Animação simples (8 frames por animação)
                const frameX = Math.floor(this.frame) * 64;
                const frameY = this.state === 'attack' ? 64 : 0;
                
                ctx.save();
                if(this.facing === -1) {
                    ctx.scale(-1, 1);
                    ctx.drawImage(this.sprite, frameX, frameY, 64, 64, -this.x-64, this.y, 64, 64);
                } else {
                    ctx.drawImage(this.sprite, frameX, frameY, 64, 64, this.x, this.y, 64, 64);
                }
                ctx.restore();
            }
        }

        // Sistema de luta
        const fighters = [
            new Fighter(200, 300, sprites.ken, { left: 'a', right: 'd', jump: 'w', attack: ' ' }),
            new Fighter(700, 300, sprites.ryu, { left: 'ArrowLeft', right: 'ArrowRight', jump: 'ArrowUp', attack: 'Enter' })
        ];

        // Sistema de input
        const keys = {};
        window.addEventListener('keydown', e => keys[e.key] = true);
        window.addEventListener('keyup', e => keys[e.key] = false);

        // Sistema de colisão
        function checkCollision(a, b) {
            return a.x < b.x + 64 &&
                   a.x + 64 > b.x &&
                   a.y < b.y + 64 &&
                   a.y + 64 > b.y;
        }

        // Game loop
        function update() {
            fighters.forEach((fighter, index) => {
                const opponent = fighters[1 - index];
                
                // Movimento
                if(keys[fighter.controls.left]) {
                    fighter.x -= 5;
                    fighter.facing = -1;
                }
                if(keys[fighter.controls.right]) {
                    fighter.x += 5;
                    fighter.facing = 1;
                }
                
                // Ataque
                if(keys[fighter.controls.attack] && fighter.state !== 'attack') {
                    fighter.setState('attack');
                    if(checkCollision(fighter, opponent)) {
                        const damage = 10 + Math.random() * 5;
                        opponent.health = Math.max(0, opponent.health - damage);
                        fighter.combo++;
                        document.getElementById(index === 0 ? 'p2-health' : 'p1-health').style.width = 
                            `${opponent.health * 3}px`;
                    }
                }

                // Limites do palco
                fighter.x = Math.max(50, Math.min(canvas.width - 114, fighter.x));
                fighter.update();
            });
        }

        function draw() {
            // Fundo
            ctx.drawImage(sprites.stage, 0, 0, canvas.width, canvas.height);
            
            // Personagens
            fighters.forEach(fighter => fighter.draw());
        }

        // Loop principal
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }
        gameLoop();
    </script>
</body>
</html>
